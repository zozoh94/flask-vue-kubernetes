---
apiVersion: batch/v1
kind: Job
metadata:
  name: init-job
spec:
  template:
    spec:
      containers:
      - name: init-container
        image: zozoh94/flask-vue-init:v1.1
        env:
          - name: POSTGRES_HOST
            valueFrom:
              configMapKeyRef:
                name: configmap
                key: postgres_host
          - name: POSTGRES_USER
            valueFrom:
              secretKeyRef:
                name: postgresql
                key: user
          - name: POSTGRES_PASSWORD
            valueFrom:
              secretKeyRef:
                name: postgresql
                key: password
          - name: FLASK_ENV
            valueFrom:
              configMapKeyRef:
                name: configmap
                key: flask_env
          - name: APP_SETTINGS
            valueFrom:
              configMapKeyRef:
                name: configmap
                key: app_settings
      restartPolicy: Never
  backoffLimit: 4
